# DMモデリング3

-- 今回の課題のSQL文の条件全般について、実際にはIDを保持して名前が重複していても問題ないようにしますが、今回は簡易的に指定しています。

## 課題1

- closure_table （閉包テーブル）

### closure_table
1. テーブル作成
   <br>
   closure_table/ddl.sql

2. データ挿入
   <br>
   以下の構成になるようにデータを挿入します。
   <br>
   closure_table/dml.sql
```
.
├── 高橋_階層0
│   ├── 高橋_階層0_ドキュメント1
│   ├── 高橋_階層0_ドキュメント2
│   └── 高橋_階層1
│       ├── 高橋_階層1_ドキュメント1
│       └── 高橋_階層2
│           ├── 高橋_階層2_ドキュメント1
│           └── 高橋_階層3
│               └── 高橋_階層3_ドキュメント1
├── 加藤_階層0
│   ├── 加藤_階層0_ドキュメント1
│   ├── 加藤_階層0_ドキュメント2
│   └── 加藤_階層1
│       ├── 加藤_階層1_ドキュメント1
│       └── 加藤_階層2
│           └── 加藤_階層2_ドキュメント1
├── 山田_階層0
│   ├── 山田_階層0_ドキュメント1
│   └── 山田_階層0_ドキュメント2
└── 中村_階層0
    ├── 中村_階層0_ドキュメント1
    └── 中村_階層0_ドキュメント2
```
確認用SQL
<br>
closure_table/check.sql

3. ユースケース
   <br>
   以下の構成になるようにデータを変更します。
   <br>
   closure_table/usecase.sql
```
.
├── 高橋_階層0                                    // ドキュメントを削除「高橋_階層0_ドキュメント2」
│   ├── 高橋_階層0_ドキュメント1                         
│   └── 高橋_階層1                                // ディレクトリを削除「高橋_階層2」
│       ├── 高橋_階層1_ドキュメント1
│       ├── 高橋_階層1_ドキュメント2                
├── 加藤_階層0
│   ├── 加藤_階層0_ドキュメント1                 
│   └── 加藤_階層1
│       ├── 加藤_階層1_ドキュメント1
│       └── 加藤_階層2
│           ├── 加藤_階層2_ドキュメント1
│           └── 加藤_階層2_ドキュメント2             // ドキュメント「加藤_階層0_ドキュメント2」を「加藤_階層0」から「加藤_階層2」に移動し、「加藤_階層2_ドキュメント2」にリネーム
└── 中村_階層0                                 
    ├── 中村_階層0_ドキュメント1
    ├── 中村_階層0_ドキュメント2
    ├── 中村_階層0_ドキュメント3                    // 中村がドキュメントを作成し、山田が編集
    └── 山田_階層0                               // ルートからディレクトリを移動。
       ├── 山田_階層0_ドキュメント1
       └── 山田_階層0_ドキュメント2
```

確認用SQL
<br>
closure_table/check.sql

## 課題2
1. マイグレーション
   <br>
   closure_table/migration.sql

2. ユースケース
   <br>
   以下の構成になるようにデータを並べ替えます。
   <br>
   closure_table/usecase2.sql
```
.
└── 中村_階層0                                 
    ├── 中村_階層0_ドキュメント1
    ├── 中村_階層0_ドキュメント3                    // 並べ替え
    ├── 中村_階層0_ドキュメント2                    // 並べ替え
```
確認用SQL
<br>
closure_table/check.sql

3. DB削除
   <br>
   closure_table/drop.sql
