# データベース設計のアンチパターンを学ぶ7

## 課題1

- レコード数が増えた場合に、パフォーマンスに影響を及ぼす可能性がある
- 検索などの際、WHERE句に削除フラグの指定を忘れる可能性がある
- 全テーブルで論理削除を採用している場合、検索する際に全テーブルの削除フラグを指定しなければならず、SQLが煩雑になる

## 課題2

- er_diagram.puml
- er_diagram.svg

## 課題3

- ECサイト
    - 誤ってキャンセルした際に、注文を復元することができない
    - 購入金額に応じてポイントを付与していたりする場合、付与済みのポイントを付与しなかったことにできない
    - キャンセル履歴が取得できず、意図的にキャンセルを行うユーザーがいた場合に観測できないため業務上の損失となる
- 学習塾
    - 夏期講習などスポットで利用した生徒が、受験が近くなりレギュラー契約する際に、過去のデータを参考にすることができない
- 自身のケース
    - 課題2は、課題の意図に沿うため別テーブルを用意し物理削除を行えるような構成にしたが、必ずしも物理削除しなくてもよいと考えている
        - 物理削除するために別テーブルにデータ移行することで、煩雑になり逆に分かりにくくなっているため
        - 年度ごとにDBを立てるなどの方法で、論理削除をしたレコードが残っても問題ないような方法があると考えている
