# 課題１

下記にプルリクエストしております。

https://github.com/sutefu23/storybook/pull/3

一応[こんな感じで](./画像.jpg)一通り確認しています。

ただライブラリがStoryBookのプラグインが予想通り動かなかったため、Playweightというものを使っており、スクリーンショットを拒絶する機能はありませんでした。

ただエラーがあった場合ビジュアルレポートが立ち上がるので分かりやすそうではありました。

# 課題２
> ビジュアルリグレッションテストとスナップショットテストを比較した時、それぞれにどのようなメリット・デメリットがあると感じましたか？

いくつかの記事を参考にテーブルとしてまとめました。

## 比較

| | ビジュアルリグレッションテスト	|スナップショットテスト|
| ---- | ---- | ---- |
|テスト対象	| スクリーンショットの差分|DOM要素。DOMのプロパティ値の差分|
|テストの壊れやすさ|壊れにくい|アプリケーションの出力と密接に結合されているため壊れやすい|
|対ユーザー|ユーザーの関心領域内|ユーザーの関心領域外|
|スケーラビリティ|画面が多くなると設定に手間が掛かり確認も大変になる。|差分が大量発生する場合はスナップショット差分のレビュー難易度が高く、見落としがち|
|メンテナンスコスト|"画像の通信状態による軽微な変化でもアラートを出してしまい開発の足を引っ張ることがある。<br>閾値の設定が難しい"|バイナリファイルが生成されるライブラリでは、大人数の開発ではコンフリクトが生じやすい|

参考:
-  [今さら聞けないビジュアルリグレッションテストをChromaticで始める](https://buildersbox.corp-sansan.com/entry/2022/08/01/110000)
- [ABEMAでスナップショットテストをやめてVisual Regression Testingに移行する話](https://developers.cyberagent.co.jp/blog/archives/29784/)

## メリットデメリット
それらを踏まえたメリットデメリット

| | ビジュアルリグレッションテスト	|スナップショットテスト|
| ---- | ---- | ---- |
|メリット|スナップショットテストでは検知できない意図しない画面上の変化を検知することができる|プロパティ値やDOM要素の変更をコードとして確認・比較することができる|
|デメリット|アプリケーションの機能的な側面やユーザビリティに関する問題はカバーできない。<br>解像度やレンダリングエンジンなどによってテスト実行結果の統一が難しく閾値の調整が必要|外部の値や環境によるスタイルの変更など、コードに現れないものは確認できない。|

### その他
ビジュアルリグレッションテストのメリットデメリットがまとまっていて分かりやすかった記事

[airsブラウザ版でページ丸ごとVisual Regression Testしたらすごいコスパ良かった](https://medium.com/eureka-engineering/pairs%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E7%89%88%E3%81%A7%E3%83%9A%E3%83%BC%E3%82%B8%E4%B8%B8%E3%81%94%E3%81%A8visual-regression-test%E3%81%97%E3%81%9F%E3%82%89%E3%82%84%E3%81%A3%E3%81%B1%E3%82%8A%E3%82%B3%E3%82%B9%E3%83%91%E8%89%AF%E3%81%8B%E3%81%A3%E3%81%9F-726ad2352ace)


# 課題３
> ビジュアルリグレッションテストに関するクイズを作成してください

### 問1. ビジュアルリグレッションテストの安定化のためにできることを1つ以上答えてください。

1. 動的コンテンツを非表示にする

ビデオや動的な画像、CSSで動かす要素などを非表示にする

参考：[Importance of Screenshot Stabilization in Visual Testing](https://www.browserstack.com/guide/screenshot-stabilization-in-visual-testing)

2. 誤差の許容範囲をピクセル単位、あるいは％で指定する

参考:[N 予備校に Visual Regression Testing を導入した話 + tips](https://blog.nnn.dev/entry/2021/04/30/110000)


3. 動画などの再生時間は停止する
4. 描画に時間を要するアニメーションなどは遅延時間を設定する

参考: [Visual Regression Testが誤検知した動画やアニメーションの問題解決](
https://tech.uzabase.com/entry/2023/02/28/100554)

### 問2.　ビジュアルリグレッションテストでUIの意図しない変更を検知する「以外」の使い方で何か思いつくものをあげてください


1. パフォーマンステストの視覚化

    特定の操作（例えば、ページのスクロールやアイテムのドラッグなど）を実行した後のUIの状態をキャプチャして、パフォーマンスの影響を視覚的に分析できます。これにより、操作によって引き起こされるレンダリングの問題を特定しやすくなります。

2. ブラウザおよびデバイスの互換性

    異なるブラウザやデバイス間でページが一貫して表示されているかを確認します。これはクロスブラウザテストとしても知られており、特にレスポンシブデザインの確認に有益です。

3. マルチリンガル/ローカライズテスト

    異なる言語でコンテンツを表示する際、文字列の長さやフォントの違いがUIに与える影響を視覚的に確認できます。これにより、ローカライズが他の言語でUIを壊さないかをチェックするのに利用できます。

※すみません。これはChatGPTに聞きました。

### 問3. Testingピラミッドに対して提唱されたTestingトロフィーにおいてビジュアルリグレッションテストはUnitTestに含まれるでしょうか。それともIntegrationTestに分類されるでしょうか


→両方。

ちなみにこれまで提唱されいてたTestingプラミッドではユニットTest重視で、統合テストは手間が多く実装は多くすべきではない、という考え方であったが、ライブラリの発達と共に実装コストが下がり、解決できる領域が拡大し、プラミッドに対してトロフィーという形が提唱された。

ビジュアルリグレッションテストは両方の領域をカバーし、解決できる範囲が広い。

参考:[今さら聞けないビジュアルリグレッションテストをChromaticで始める - 3. Testing Trophy という新しいトレンド](https://buildersbox.corp-sansan.com/entry/2022/08/01/110000#3-Testing-Trophy-%E3%81%A8%E3%81%84%E3%81%86%E6%96%B0%E3%81%97%E3%81%84%E3%83%88%E3%83%AC%E3%83%B3%E3%83%89)

- その他「TestingTropy」について興味深い記事

この中で、自分に是非は判断できないが「モックをなるべくやめるべき」「実装の詳細をテストすべきではない」という主張が照会されており、一理あるのかもしれないと思った。

参考：[Testing Trophyとは〜フロントエンドテストについて学んでみた〜](https://buildersbox.corp-sansan.com/entry/2022/08/01/110000)