# 課題１
> 以下の用語を説明してください：

## IAMユーザ
***IAMユーザーを一言で言うと、「AWSリソースへのアクセスを持つ個別のアカウント」です。***

IAM（アイエム）ユーザーは、AWSのIdentity and Access Management（アイデンティティとアクセス管理）の機能の一つです。
IAMユーザーは、AWSリソースへのアクセスや操作を行うために使用されるアカウントです。

## IAMユーザーグループ
***IAMユーザーグループを一言で言うと、「複数のIAMユーザーに対して共通のアクセス許可を管理するための集合」です。***

IAM ユーザーグループとは、IAM ユーザーの集合です。
ユーザーグループを使用すると、複数のユーザーに対してアクセス許可を指定でき、それらのユーザーのアクセス許可を容易に管理することができます。

## IAMポリシー
***IAMポリシーを一言で言うと、「AWSリソースへのアクセス許可を定義するJSON形式のドキュメント」です。***

AWS でのアクセスを管理するには、ポリシーを作成し、IAM アイデンティティ (ユーザー、ユーザーのグループ、ロール) または AWS リソースにアタッチします。
ポリシーは AWS のオブジェクトであり、アイデンティティやリソースに関連付けて、これらのアクセス許可を定義します。

### アイデンティティベースのポリシー
アイデンティティベースのポリシーは、アイデンティティ (ユーザー、ユーザーのグループ、ロール) が実行できるアクション、リソース、および条件を制御する JSON アクセス許可ポリシードキュメントです。

### リソースベースのポリシー
リソースベースのポリシーは、Amazon S3 バケットなどのリソースにアタッチする JSON ポリシードキュメントです。
これらのポリシーでは、そのリソースに対して特定のアクションを実行するために指定されたプリンシパルのアクセス許可を付与するとともに、このアクセス許可が適用される条件を定義します。

## IAMロール
***IAMロールを一言で言うと、「特定のアクセス許可を持ち、AWSリソースへのアクセスを一時的に委任するためのアイデンティティ」です。***

IAM ロールは、特定の許可があり、アカウントで作成できるもう 1 つの IAM アイデンティティです。
IAM ロールは、アイデンティティが AWS で実行できることとできないことを決定するアクセス許可ポリシーを持つ AWS アイデンティティであるという点で IAM ユーザーと似ています。
ただし、ユーザーは 1 人の特定の人に一意に関連付けられますが、ロールはそれを必要とする任意の人が引き受けるようになっています。
また、ロールには標準の長期認証情報 (パスワードやアクセスキーなど) も関連付けられません。代わりに、ロールを引き受けると、ロールセッション用の一時的なセキュリティ認証情報が提供されます。

## Permission boundary（アクセス許可境界）
***Permission boundaryを一言で言うと、「IAMエンティティ（ユーザーまたはロール）に対して許可される最大の権限を制限するための管理ポリシー」です。***

アクセス許可境界は、管理されたポリシーを使用して、ID ベースのポリシーが IAM エンティティに付与 できる最大の許可を設定するための高度な機能である。
エンティティの権限アクセス許可境界によって、エンティティは ID ベースのポリシーとアクセス許可境界の両方で許可されているアクションのみを実行できるようになる。

## AWS マネージドポリシー、カスタマー管理ポリシー
### AWS マネージドポリシー
***AWS マネージドポリシーを一言で言うと、「AWSが作成および管理するスタンドアロンポリシー」です。***
AWS 管理ポリシーは、AWS が作成および管理するスタンドアロンポリシーです。
スタンドアロンポリシーとは、ポリシー名が含まれている独自の Amazon リソースネーム ([ARN](https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_identifiers.html#identifiers-arns)) の付いたポリシーです。

AWS 管理ポリシーは、ユーザー、IAM グループおよびロールに適切な権限を割り当てるのに便利です。
ポリシーを自分で作成するよりも簡単で、多くの一般的なユースケースに対応したアクセス許可が含まれています。

### カスタマー管理ポリシー
***カスタマー管理ポリシーを一言で言うと、「特定のユースケースに合わせて作成し、何度でも変更や更新が可能なポリシー」です。***

プリンシパルエンティティ ((IAM ユーザー、IAM グループ、および IAM ロール) にアタッチできる単独のポリシーを独自の AWS アカウント に作成することができます。
これらのカスタマー管理ポリシーは、特定のユースケースに合わせて作成し、何度でも変更および更新が可能です。
カスタマー管理ポリシーを作成する優れた方法は、既存の AWS 管理ポリシーをコピーして開始することです。この方法で、最初の段階でポリシーが正しいことがわかっていれば、ご使用の環境に合わせて必要なカスタマイズを行うことができます。

## ホワイトリストパターン、ブラックリストパターン
IAMポリシーの設計のデザインパターン
### ホワイトリストパターン
```
{
  "Effect": "Allow",
  "Action": [
    "s3:List*",
    "s3:Get*"
  ],
  "Resource": [
    "arn:aws:s3:::confidential-data",
    "arn:aws:s3:::confidential-data/*"
  ],
  "Condition": {
    "Bool": {"aws:MultiFactorAuthPresent": "true"}
  }
}
```
最も基本的（直感的）なデザインパターンです。
ネーミングからもお分かりかと思いますが、明示的許可のみを行います。
許可を記述していないアクションについては暗黙的に拒否されるため、このポリシーの与える権限の範囲が明確なのが特徴です。

### ブラックリストパターン
```
{
    "Version": "2012-10-17",
    "Statement": {
        "Effect": "Deny",
        "Action": "*",
        "Resource": "*",
        "Condition": {
            "NotIpAddress": {
                "aws:SourceIp": [
                    "192.0.2.0/24",
                    "203.0.113.0/24"
                ]
            },
            "Bool": {"aws:ViaAWSService": "false"}
        }
    }
}
```
こちらも名前から明らかですが、明示的拒否のみを行うパターンです。
明示的拒否は最も強いEffectであり、一度このポリシーをアタッチしてしまうと、該当するアクションの権限は他のポリシーにより上書きすることができなくなります。
とても強い主張のため、以下のような条件を満たしていなければ権限を与えないという文脈で利用されることが多いです。

MFA未認証
VPCやAWSサービス外からのアクセス
指定の範囲外のソースIP etc.

# 課題２
> （ユーザ）
## 毎回ルートユーザとしてアクセスしなくても済むように、管理者権限を持ったIAMユーザを作成してみましょう
## 以降の操作はルートユーザではなく、ここで作成した「管理者権限を持つIAMユーザ」を使いましょう！
## 質問：なぜ毎回ルートユーザとしてアクセスするのではなく、管理者権限のIAMユーザでログインした方が良いのでしょうか？
## 質問：新たな職場に加わり「AWSを扱うためのアカウントをください」とお願いしたところ「このIAMユーザーを社内のエンジニアで共有してるから、ID/passを教えるね」と言われました。このようにひとつのIAMユーザーを使い回すことにはどのような問題があるでしょうか？
## PowerUserAccessポリシーを付与したIAMユーザを新規作成してください
## 上記ユーザでAWSコンソールにログインして、IAMのダッシュボードを開くと、どのようなエラーメッセージが表示されますか？そのエラーメッセージはなぜ表示されるのでしょうか？
### 質問：少し前の課題で「管理者権限を持ったIAMユーザー」を作成した方の中には「AdministratorAccess」ポリシーを付与したユーザーを作成した方もいたのではないでしょうか。PowerUserAccessと非常に似たポリシーのように見えますが、この2つのポリシーは何が違うのでしょうか？
### 質問：PowerUserAccessのようにAWSが用意してくれているポリシーを「AWS管理ポリシー」と呼びます。開発者が自ら追加したポリシーは「カスタマー管理ポリシー」と呼ばれます。これらはどのように使い分けると良いのでしょうか？


> （グループ）
## Administratorsという名前のグループを作成して、AdministratorAccessのポリシーを付与してみましょう
## 上記のグループを作成し終えたら、新たなIAMユーザを作成してください
### このユーザは何もポリシーを持っていない状態で大丈夫です！
## 上記ユーザをAdministratorsグループに所属させてください
## 上記ユーザでコンソールにログインしてみましょう。無事ログインできればOKです！
## 質問：AdministratorAccessポリシーを直接ユーザに付与する方法と、グループに付与してユーザを所属させる方法があります。どのような理由で、どちらの方が適切だと感じますか？

> （サービスのIAM）
## IAMはユーザのみならず、AWS上のサービス（EC2やS3など）にも適用されます。試しにEC2からS3にアクセスできるようなIAM設定を作ってみましょう！
## EC2インスタンスを1つ作成してください（任意の名前以外は何も設定を変えず、全てデフォルト設定で作成して構いません）
## S3バケットを作成してください（任意の名前以外は何も設定を変えず、全てデフォルト設定で作成して構いません）
## EC2インスタンスにSSH接続して上記S3バケットの中身を一覧表示するaws cliコマンドを実行してください。一切コマンドが実行できず、エラーが発生するはずです
## 上記aws cliコマンドが成功するようにロールを付与してみましょう！
## 上記S3バケットに対してのみ、バケットに保存されているオブジェクトを一覧表示する操作を許可するロールをEC2インスタンスに付与してみましょう

> （設計方針）
## 質問：アクセス制御には大まかに分けると「ホワイトリスト方式」「ブラックリスト方式」と呼ばれる設計方針があります。それぞれどのようなメリット・デメリットがあるでしょう？また、それぞれの方式を取り入れているサービスの例を探してみてください
## 質問：一度設定したIAMやS3などのルールがきちんと守られているか、ユーザーが全員MFAを有効にしているかなど、継続的に人力でチェックし続けるのは現実的ではありませんよね。何かAWSでリソースに対するルールの自動チェックを行ってくれるサービスは用意されていないでしょうか・・・？

# 課題３
## IAMに関するクイズを作成してください

# （任意課題）
## 「毎回ポリシーを変更するたびに、設定内容の動作を確認するの大変だな・・・」と感じた方は、awsが提供するポリシーシミュレータを使ってみるのも手かもしれません！
